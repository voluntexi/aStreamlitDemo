import clueai
import streamlit as st
def introduction():
    st.markdown('''
    # å…¨ä¸­æ–‡ä»»åŠ¡æ”¯æŒé›¶æ ·æœ¬å­¦ä¹ æ¨¡å‹

[PromptCLUE](https://github.com/clue-ai/PromptCLUE)ï¼šæ”¯æŒæœ€å¤šä¸­æ–‡ä»»åŠ¡çš„å¼€æºé¢„è®­ç»ƒæ¨¡å‹

è¿™ä¸ªæ¨¡å‹æ˜¯åŸºäº1000äº¿tokenä¸­æ–‡è¯­æ–™ä¸Šé¢„è®­ç»ƒï¼Œå¹¶ä¸”åœ¨æ•°ç™¾ç§ä»»åŠ¡ä¸Šè¿›è¡ŒPromptä»»åŠ¡å¼è®­ç»ƒã€‚é’ˆå¯¹ç†è§£ç±»ä»»åŠ¡ï¼Œå¦‚åˆ†ç±»ã€æƒ…æ„Ÿåˆ†æã€æŠ½å–ç­‰ï¼Œå¯ä»¥è‡ªå®šä¹‰æ ‡ç­¾ä½“ç³»ï¼›é’ˆå¯¹å¤šç§ç”Ÿæˆä»»åŠ¡ï¼Œå¯ä»¥è¿›è¡Œé‡‡æ ·è‡ªç”±ç”Ÿæˆã€‚

## æ¨¡å‹æè¿°

æ”¯æŒå‡ åä¸ªä¸åŒç±»å‹çš„ä»»åŠ¡ï¼Œå…·æœ‰è¾ƒå¥½çš„é›¶æ ·æœ¬å­¦ä¹ èƒ½åŠ›å’Œå°‘æ ·æœ¬å­¦ä¹ èƒ½åŠ›ã€‚é’ˆå¯¹ç†è§£ç±»ä»»åŠ¡ï¼Œå¦‚åˆ†ç±»ã€æƒ…æ„Ÿåˆ†æã€æŠ½å–ç­‰ï¼Œå¯ä»¥è‡ªå®šä¹‰æ ‡ç­¾ä½“ç³»ï¼›é’ˆå¯¹ç”Ÿæˆä»»åŠ¡ï¼Œå¯ä»¥è¿›è¡Œé‡‡æ ·è‡ªç”±ç”Ÿæˆã€‚åƒäº¿ä¸­æ–‡tokenä¸Šå¤§è§„æ¨¡é¢„è®­ç»ƒï¼Œç´¯è®¡å­¦ä¹ 1.5ä¸‡äº¿ä¸­æ–‡tokenï¼Œäº¿çº§ä¸­æ–‡ä»»åŠ¡æ•°æ®ä¸Šå®Œæˆè®­ç»ƒï¼Œè®­ç»ƒä»»åŠ¡è¶…è¿‡150+ã€‚æ¯”baseç‰ˆå¹³å‡ä»»åŠ¡æå‡7ä¸ªç‚¹+ï¼›å…·æœ‰æ›´å¥½çš„ç†è§£ã€ç”Ÿæˆå’ŒæŠ½å–èƒ½åŠ›ï¼Œå¹¶ä¸”æ”¯æŒæ–‡æœ¬æ”¹å†™ã€çº é”™ã€çŸ¥è¯†å›¾è°±é—®ç­”ã€‚ å®ç°äº†ä¸­æ–‡ä¸Šçš„ä¸‰å¤§ç»Ÿä¸€ï¼šç»Ÿä¸€æ¨¡å‹æ¡†æ¶ï¼Œç»Ÿä¸€ä»»åŠ¡å½¢å¼ï¼Œç»Ÿä¸€åº”ç”¨æ–¹å¼ã€‚

- ç»Ÿä¸€æ¨¡å‹æ¡†æ¶ï¼šé‡‡ç”¨Text-to-Textçš„ç”Ÿæˆå¼é¢„è®­ç»ƒæ¨¡å‹è¿›è¡Œç»Ÿä¸€å»ºæ¨¡ã€‚
- ç»Ÿä¸€ä»»åŠ¡å½¢å¼ï¼šPromptç»Ÿä¸€ä¸åŒçš„NLPä»»åŠ¡é—´çš„å·®å¼‚ï¼Œè½¬åŒ–ä¸ºç»Ÿä¸€çš„text-to-textæ•°æ®å½¢å¼ã€‚
- ç»Ÿä¸€åº”ç”¨æ–¹å¼ï¼šå¯¹ç›®æ ‡ä»»åŠ¡å½¢æˆæ‹¿æ¥å³ç”¨çš„æ¨¡å‹ï¼Œä¸‹æ¸¸åº”ç”¨æ—¶éƒ½å¯è½¬åŒ–ä¸ºç»Ÿä¸€çš„promptè‡ªé€‚åº”æ–¹å¼ï¼Œè¿›è¡Œzero-shot/few-shotæµ‹è¯•ã€‚

### æ¨¡å‹å±€é™æ€§åŠå¯èƒ½çš„åå·®

æˆ‘ä»¬çš„æ¨¡å‹åŸºäºå¤§è§„æ¨¡NLPæ•°æ®é›†ï¼ˆå¦‚[pCLUE](https://github.com/CLUEbenchmark/pCLUE)ï¼‰ï¼Œå„é¢†åŸŸç»¼åˆè¡¨ç°ç´ è´¨è¾ƒé«˜ï¼Œä½†åœ¨æŸäº›å‚ç›´é¢†åŸŸå¯èƒ½è¡¨ç°ç¨å¼±ï¼›

## è®­ç»ƒæ•°æ®ä»‹ç»

pCLUEï¼šåŸºäºæç¤ºçš„å¤§è§„æ¨¡é¢„è®­ç»ƒæ•°æ®é›†ï¼Œç”¨äºå¤šä»»åŠ¡å­¦ä¹ å’Œé›¶æ ·æœ¬å­¦ä¹ 

### ç›®å‰å·²ç»æœ‰åŒ…å«9ä¸ªæ•°æ®é›†ï¼š

```
1.å•åˆ†ç±»tnews 
2.å•åˆ†ç±»iflytek 
3.è‡ªç„¶è¯­è¨€æ¨ç†ocnli 
4.è¯­ä¹‰åŒ¹é…afqmc 
5.æŒ‡ä»£æ¶ˆè§£-cluewsc2020 
6.å…³é”®è¯è¯†åˆ«-csl 
7.é˜…è¯»ç†è§£-è‡ªç”±å¼c3 
8.é˜…è¯»ç†è§£-æŠ½å–å¼cmrc2018 
9.é˜…è¯»ç†è§£-æˆè¯­å¡«ç©ºchid 
```

### å­—æ®µè¯´æ˜åŠè¯„ä»·æ ‡å‡†ï¼š

```
input:æ¨¡å‹çš„è¾“å…¥
target:æ¨¡å‹çš„è¾“å‡º
type:ä»»åŠ¡ç±»å‹ï¼Œé˜…è¯»ç†è§£(mrc),åˆ†ç±»(classify)ï¼Œç”Ÿæˆ(generate)ï¼Œè‡ªç„¶è¯­è¨€æ¨ç†(nli)
è¯„ä»·æ ‡å‡†ï¼šé˜…è¯»ç†è§£(em),åˆ†ç±»(acc)ï¼Œç”Ÿæˆ(em)ï¼Œè‡ªç„¶è¯­è¨€æ¨ç†(acc)
answer_choices:é€‰é¡¹ï¼ˆåªæœ‰åˆ†ç±»ã€æ¨ç†ç±»ä»»åŠ¡æœ‰ï¼‰
```

## æ•°æ®è¯„ä¼°åŠç»“æœ

æ•ˆæœå¯¹æ¯”--16ç±»ä¸­æ–‡ä»»åŠ¡

|            ä»»åŠ¡ç±»å‹            | PromptCLUE-base | PromptCLUE-large |
| :----------------------------: | :-------------: | :--------------: |
|         **åˆ†æ•°** Score         |      63.47      |   70.55(+7.08)   |
|        å‚æ•° Parameters         |      220M       |       770M       |
|   **ç†è§£ä»»åŠ¡**ï¼ˆaccï¼Œ10ç±»ï¼‰    |                 |                  |
|         åˆ†ç±» classify          |      89.56      |      92.89       |
|   æƒ…æ„Ÿåˆ†æ emotion_analysis    |      80.55      |      85.64       |
|       ç›¸ä¼¼åº¦è®¡ç®— similar       |      70.94      |      78.47       |
|        è‡ªç„¶è¯­è¨€æ¨ç† nli        |      78.00      |      86.67       |
|  æŒ‡ä»£æ¶ˆè§£ anaphora_resolution  |      30.00      |      64.00       |
| é˜…è¯»ç†è§£ reading_comprehension |      71.69      |      84.78       |
| å…³é”®è¯æå– keywords_extraction |      41.44      |      47.78       |
|          ä¿¡æ¯æŠ½å– ner          |      63.02      |      70.09       |
|  çŸ¥è¯†å›¾è°±é—®ç­” knowledge_graph  |        -        |      53.11       |
| ä¸­å¿ƒè¯æå– Keyword_extraction  |      66.50      |      71.50       |
|   **ç”Ÿæˆä»»åŠ¡**ï¼ˆrougeï¼Œ6ç±»ï¼‰   |                 |                  |
|     ç¿»è¯‘ï¼ˆè‹±ä¸­ã€ä¸­è‹±ï¼‰ nmt     |      55.92      |      59.67       |
|          æ‘˜è¦ summary          |      31.71      |      34.48       |
|            é—®ç­” qa             |      21.18      |      27.05       |
|     ç”Ÿæˆï¼ˆæ–‡ç« ã€é—®é¢˜ç”Ÿæˆï¼‰     |      35.86      |      39.87       |
|        æ”¹å†™ paraphrase         |        -        |      57.68       |
|          çº é”™ correct          |        -        |      93.35       |
    
    
    ''')
if __name__ == '__main__':
    cl = clueai.Client('wTzinq_UcR-eYoS0iZuEc101001011')
    st.markdown("# Hi! ğŸ–ï¸ğŸ–ï¸ğŸ–ï¸\n"
                "# è¿™æ˜¯ä¸€ä¸ªæ–‡æœ¬æ‘˜è¦åœ¨çº¿ç”Ÿæˆå·¥å…·\n"
                "ä¸çŸ¥é“å¦‚ä½•ä½¿ç”¨\nï¼Ÿ"
                "å¾ˆç®€å•ï¼šåªéœ€è¦å°†æ–‡æœ¬å¤åˆ¶åˆ°**æ–‡æœ¬æ¡†**ä¸­ï¼Œå†ç‚¹å‡»**ç”Ÿæˆ**å°±å¯ä»¥äº†"
                ""
                "")
    phrase = 'å¯¹äºç¾æ–¹æå‡ºä¸¤å›½å…ƒé¦–åœ¨å·´å˜å²›ä¸¾è¡Œä¼šæ™¤ç­‰æ¶‰åè¨€è®ºï¼Œåœ¨ä»Šå¤©ï¼ˆ10æ—¥ï¼‰ä¸¾è¡Œçš„ä¸­å›½å¤–äº¤éƒ¨ä¾‹è¡Œè®°è€…ä¼šä¸Šï¼Œå‘è¨€äººèµµç«‹åšè¡¨ç¤ºï¼Œä¸­ç¾ä¸¤å›½å…ƒé¦–é€šè¿‡å¤šç§æ–¹å¼ä¿æŒç»å¸¸æ€§è”ç³»ã€‚ä¸­æ–¹é‡è§†ç¾æ–¹æå‡ºä¸¤å›½å…ƒé¦–åœ¨å·´å˜å²›ä¸¾è¡Œä¼šæ™¤çš„å»ºè®®ï¼Œç›®å‰åŒæ–¹æ­£å°±æ­¤ä¿æŒæ²Ÿé€šã€‚ä¸­æ–¹å¯¹ç¾æ”¿ç­–ç«‹åœºæ˜¯ä¸€è´¯å’Œæ˜ç¡®çš„ï¼Œæˆ‘ä»¬è‡´åŠ›äºåŒç¾æ–¹å®ç°ç›¸äº’å°Šé‡ã€å’Œå¹³å…±å¤„ã€åˆä½œå…±èµ¢ï¼ŒåŒæ—¶åšå®šæå«è‡ªèº«ä¸»æƒå®‰å…¨å‘å±•åˆ©ç›Šã€‚'
    st.markdown(f" **ç¤ºä¾‹æ–‡æœ¬ï¼š**\n  >{phrase} ")
    st.markdown(f" **ç¤ºä¾‹è¾“å‡ºï¼š**\n  >å¤–äº¤éƒ¨ï¼šä¸­æ–¹é‡è§†ç¾æ–¹æè®®ä¸¤å›½å…ƒé¦–å·´å˜å²›ä¼šæ™¤ ")
    st.markdown("ğŸ˜ŠğŸ˜Š \n **å·²ç»äº†è§£äº†?æ¥ä¸‹æ¥å¼€å§‹æ–‡æœ¬ä½ çš„æ–‡æœ¬æ‘˜è¦ä¹‹æ—…å§ï¼**")
    text = st.text_area("åœ¨æ­¤è¾“å…¥",height=50)
    # generate a prediction for a prompt
    butt = st.button("ç”Ÿæˆ")
    if butt and text != "":
        prompt = f'''
                  æ¦‚æ‹¬æ–‡ç« ä¸­å¿ƒæ€æƒ³ï¼š{text}
                  æ‘˜è¦ï¼š?
                  '''
        # print the predicted text
        prediction = cl.generate(
            model_name='clueai-large',
            prompt=prompt)
        st.markdown(f"**ç”Ÿæˆæ‘˜è¦ï¼š**\n > {prediction.generations[0].text}")
        st.balloons()
    st.write("\n")
    st.write("\n")
    st.write("\n")
    st.write("\n")
    click=1
    c=st.button("æ¨¡å‹ä»‹ç»")
    if c:
        introduction()


